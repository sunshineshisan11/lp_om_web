{"version":3,"file":"videoAuto.4ad23054.js","sources":["../../src/components/videoAuto.vue"],"sourcesContent":["<template>\r\n\t<div id=\"app\">\r\n\t\t<el-icon class=\"back\" size=\"40\" @click=\"router.back()\">\r\n\t\t\t<ArrowLeftBold />\r\n\t\t</el-icon>\r\n\t\t<div class=\"video-container\" @touchstart=\"onTouchStart\" @touchmove=\"onTouchMove\" @touchend=\"onTouchEnd\">\r\n\t\t\t<div v-for=\"(video, index) in visibleVideos\" :key=\"index\" class=\"video-item\">\r\n\t\t\t\t<!-- 视频加载时显示封面图片 -->\r\n\t\t\t\t<img v-if=\"!videoLoaded[index]\" :src=\"$domain+'/'+video.cover\" alt=\"Video Cover\" class=\"video-cover\">\r\n\t\t\t\t<video ref=\"videoRefs[index]\" :src=\"$domain+'/'+video.url\" playsinline autoplay muted\r\n\t\t\t\t\t@loadeddata=\"onVideoLoaded(index)\"></video>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t</div>\r\n</template>\r\n\r\n<script setup>\r\n\timport {\r\n\t\tref,\r\n\t\tonMounted,\r\n\t\twatchEffect\r\n\t} from 'vue';\r\n\timport {\r\n\t\tuseRouter,\r\n\t\tuseRoute\r\n\t} from 'vue-router';\r\n\t// 模拟视频数据，包含视频链接和封面图链接\r\n\tconst videoList = [\r\n\t\t[{\r\n\t\t\t\turl: 'yc1.MP4',\r\n\t\t\t\tcover: 'yc1.jpg'\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\turl: 'yc2.MP4',\r\n\t\t\t\tcover: 'yc2.jpg'\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\turl: 'yc3.MP4',\r\n\t\t\t\tcover: 'yc3.jpg'\r\n\t\t\t}\r\n\t\t],\r\n\t\t[{\r\n\t\t\t\turl: 'yt1.MP4',\r\n\t\t\t\tcover: 'yt1.jpg'\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\turl: 'yt2.MP4',\r\n\t\t\t\tcover: 'yt2.jpg'\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\turl: 'yt3.MP4',\r\n\t\t\t\tcover: 'yt3.jpg'\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\turl: 'yt4.MP4',\r\n\t\t\t\tcover: 'yt4.jpg'\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\turl: 'yt5.MP4',\r\n\t\t\t\tcover: 'yt5.jpg'\r\n\t\t\t},\r\n\t\t],\r\n\t\t[{\r\n\t\t\turl: 'bs1.MP4',\r\n\t\t\tcover: 'bs1.jpg'\r\n\t\t},{\r\n\t\t\turl: 'bs2.MP4',\r\n\t\t\tcover: 'bs2.jpg'\r\n\t\t}]\r\n\t]\r\n\tconst router = useRouter()\r\n\tlet type = ref(0)\r\n\tconst route = useRoute();\r\n\ttype.value = route.query.type\r\n\tconsole.log(type.value)\r\n\tconst videos = videoList[type.value]\r\n\tconsole.log(videos)\r\n\t// 当前视频索引\r\n\tconst currentIndex = ref(0);\r\n\t// 可见视频列表\r\n\tconst visibleVideos = ref([videos[currentIndex.value]]);\r\n\t// 视频元素引用数组\r\n\tconst videoRefs = ref([]);\r\n\t// 记录每个视频是否加载完成\r\n\tconst videoLoaded = ref(videos.map(() => false));\r\n\r\n\t// 触摸事件相关变量\r\n\tlet startY = 0;\r\n\tlet isSwiping = false;\r\n\r\n\tconst onTouchStart = (event) => {\r\n\t\tstartY = event.touches[0].clientY;\r\n\t\tisSwiping = true;\r\n\t};\r\n\r\n\tconst onTouchMove = (event) => {\r\n\t\tif (!isSwiping) return;\r\n\t\tconst currentY = event.touches[0].clientY;\r\n\t\tconst deltaY = currentY - startY;\r\n\t\t// 这里可以添加滑动动画效果\r\n\t};\r\n\r\n\tconst onTouchEnd = (event) => {\r\n\t\tif (!isSwiping) return;\r\n\t\tconst currentY = event.changedTouches[0].clientY;\r\n\t\tconst deltaY = currentY - startY;\r\n\t\tif (deltaY < -50) {\r\n\t\t\t// 向上滑动，切换到下一个视频\r\n\t\t\tif (currentIndex.value < videos.length - 1) {\r\n\t\t\t\tcurrentIndex.value++;\r\n\t\t\t\tvisibleVideos.value = [videos[currentIndex.value]];\r\n\t\t\t\tvideoLoaded.value = videos.map(() => false);\r\n\t\t\t\tpreloadNextVideo();\r\n\t\t\t}\r\n\t\t} else if (deltaY > 50) {\r\n\t\t\t// 向下滑动，切换到上一个视频\r\n\t\t\tif (currentIndex.value > 0) {\r\n\t\t\t\tcurrentIndex.value--;\r\n\t\t\t\tvisibleVideos.value = [videos[currentIndex.value]];\r\n\t\t\t\tvideoLoaded.value = videos.map(() => false);\r\n\t\t\t}\r\n\t\t}\r\n\t\tisSwiping = false;\r\n\t};\r\n\r\n\tconst preloadNextVideo = () => {\r\n\t\tif (currentIndex.value < videos.length - 1) {\r\n\t\t\tconst nextVideoIndex = currentIndex.value + 1;\r\n\t\t\tconst nextVideo = new Audio(videos[nextVideoIndex].url);\r\n\t\t\tnextVideo.preload = 'auto';\r\n\t\t}\r\n\t};\r\n\r\n\tconst onVideoLoaded = (index) => {\r\n\t\tvideoLoaded.value[index] = true;\r\n\t};\r\n\r\n\tonMounted(() => {\r\n\t\tpreloadNextVideo();\r\n\t\twatchEffect(() => {\r\n\t\t\tconst video = videoRefs.value[currentIndex.value];\r\n\t\t\tif (video) {\r\n\t\t\t\tvideo.load();\r\n\t\t\t\tvideo.play();\r\n\t\t\t}\r\n\t\t});\r\n\t});\r\n</script>\r\n\r\n<style scoped>\r\n\t.back {\r\n\t\tposition: absolute;\r\n\t\tleft: 10px;\r\n\t\ttop: 10px;\r\n\t\tz-index: 9;\r\n\t}\r\n\t.video-container {\r\n\t\twidth: 100%;\r\n\t\theight: 100vh;\r\n\t\tdisplay: flex;\r\n\t\tjustify-content: center;\r\n\t\talign-items: center;\r\n\t\tbackground-color: #000;\r\n\t\toverflow: hidden;\r\n\t}\r\n\r\n\t.video-item {\r\n\t\twidth: 100%;\r\n\t\theight: 100%;\r\n\t\tposition: relative;\r\n\t}\r\n\r\n\t.video-cover {\r\n\t\twidth: 100%;\r\n\t\theight: 100%;\r\n\t\tobject-fit: cover;\r\n\t\tposition: absolute;\r\n\t\ttop: 0;\r\n\t\tleft: 0;\r\n\t\tz-index: 1;\r\n\t}\r\n\r\n\tvideo {\r\n\t\twidth: 100%;\r\n\t\theight: 100%;\r\n\t\tobject-fit: cover;\r\n\t\tposition: relative;\r\n\t\tz-index: 2;\r\n\t}\r\n</style>"],"names":["videoList","router","useRouter","type","ref","route","useRoute","videos","currentIndex","visibleVideos","videoRefs","videoLoaded","startY","isSwiping","onTouchStart","event","onTouchMove","onTouchEnd","deltaY","preloadNextVideo","nextVideoIndex","nextVideo","onVideoLoaded","index","onMounted","watchEffect","video"],"mappings":"uOA2BC,MAAMA,EAAY,CACjB,CAAC,CACC,IAAK,UACL,MAAO,SACP,EACD,CACC,IAAK,UACL,MAAO,SACP,EACD,CACC,IAAK,UACL,MAAO,SACP,CACD,EACD,CAAC,CACC,IAAK,UACL,MAAO,SACP,EACD,CACC,IAAK,UACL,MAAO,SACP,EACD,CACC,IAAK,UACL,MAAO,SACP,EACD,CACC,IAAK,UACL,MAAO,SACP,EACD,CACC,IAAK,UACL,MAAO,SACP,CACD,EACD,CAAC,CACA,IAAK,UACL,MAAO,SACV,EAAI,CACD,IAAK,UACL,MAAO,SACV,CAAG,CACD,EACKC,EAASC,EAAW,EAC1B,IAAIC,EAAOC,EAAI,CAAC,EAChB,MAAMC,EAAQC,IACdH,EAAK,MAAQE,EAAM,MAAM,KACzB,QAAQ,IAAIF,EAAK,KAAK,EACtB,MAAMI,EAASP,EAAUG,EAAK,OAC9B,QAAQ,IAAII,CAAM,EAElB,MAAMC,EAAeJ,EAAI,CAAC,EAEpBK,EAAgBL,EAAI,CAACG,EAAOC,EAAa,MAAM,CAAC,EAEhDE,EAAYN,EAAI,CAAA,CAAE,EAElBO,EAAcP,EAAIG,EAAO,IAAI,IAAM,EAAK,CAAC,EAG/C,IAAIK,EAAS,EACTC,EAAY,GAEhB,MAAMC,EAAgBC,GAAU,CAC/BH,EAASG,EAAM,QAAQ,GAAG,QAC1BF,EAAY,EACd,EAEOG,EAAeD,GAAU,CAC1B,CAACF,GACYE,EAAM,QAAQ,GAAG,OAGpC,EAEOE,EAAcF,GAAU,CAC7B,GAAI,CAACF,EAAW,OAEhB,MAAMK,EADWH,EAAM,eAAe,GAAG,QACfH,EACtBM,EAAS,IAERV,EAAa,MAAQD,EAAO,OAAS,IACxCC,EAAa,QACbC,EAAc,MAAQ,CAACF,EAAOC,EAAa,MAAM,EACjDG,EAAY,MAAQJ,EAAO,IAAI,IAAM,EAAK,EAC1CY,KAESD,EAAS,IAEfV,EAAa,MAAQ,IACxBA,EAAa,QACbC,EAAc,MAAQ,CAACF,EAAOC,EAAa,MAAM,EACjDG,EAAY,MAAQJ,EAAO,IAAI,IAAM,EAAK,GAG5CM,EAAY,EACd,EAEOM,EAAmB,IAAM,CAC9B,GAAIX,EAAa,MAAQD,EAAO,OAAS,EAAG,CAC3C,MAAMa,EAAiBZ,EAAa,MAAQ,EACtCa,EAAY,IAAI,MAAMd,EAAOa,GAAgB,GAAG,EACtDC,EAAU,QAAU,MACpB,CACH,EAEOC,EAAiBC,GAAU,CAChCZ,EAAY,MAAMY,GAAS,EAC7B,EAEC,OAAAC,EAAU,IAAM,CACfL,IACAM,EAAY,IAAM,CACjB,MAAMC,EAAQhB,EAAU,MAAMF,EAAa,OACvCkB,IACHA,EAAM,KAAI,EACVA,EAAM,KAAI,EAEd,CAAG,CACH,CAAE"}