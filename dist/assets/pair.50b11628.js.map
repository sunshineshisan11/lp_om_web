{"version":3,"file":"pair.50b11628.js","sources":["../../src/components/pair.vue"],"sourcesContent":["<template>\r\n\t<div class=\"main\">\r\n\t\t<div class=\"sec\">\r\n\t\t\t<div class=\"man\">\r\n\t\t\t\t<div class=\"avatar\">\r\n\t\t\t\t\t<img :src=\"$domain + '/' + store.user.avatar\" />\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class=\"pz\">\r\n\t\t\t\t\t<!-- 实例图片无效，暂时没删 -->\r\n\t\t\t\t\t<el-upload class=\"avatar-uploader\" action=\"https://www.findyourflame.vip:168/upload/pz\"\r\n\t\t\t\t\t\t:show-file-list=\"false\" :before-upload=\"(file) => beforeUpload(file, 0)\"\r\n\t\t\t\t\t\t:on-success=\"(response) => handleSuccess(response, 0)\" :on-error=\"handleError\">\r\n\t\t\t\t\t\t<img v-if=\"imageUrl[0]\" :src=\"imageUrl[0]\" class=\"avatarEdit\" />\r\n\t\t\t\t\t\t<template v-else>\r\n\t\t\t\t\t\t\t<img v-if=\"store.user.pz\" :src=\"$domain + '/' + store.user.pz\" class=\"avatarEdit\" />\r\n\t\t\t\t\t\t\t<template v-else>\r\n\t\t\t\t\t\t\t\t{{ lang.mine.upload[0] }}\r\n\t\t\t\t\t\t\t</template>\r\n\t\t\t\t\t\t</template>\r\n\t\t\t\t\t</el-upload>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class=\"pz\">\r\n\t\t\t\t\t<el-upload class=\"avatar-uploader\" action=\"https://www.findyourflame.vip:168/upload/pz\"\r\n\t\t\t\t\t\t:show-file-list=\"false\" :before-upload=\"(file) => beforeUpload(file, 1)\"\r\n\t\t\t\t\t\t:on-success=\"(response) => handleSuccess(response, 1)\" :on-error=\"handleError\">\r\n\r\n\t\t\t\t\t\t<img v-if=\"imageUrl[1]\" :src=\"imageUrl[1]\" class=\"avatarEdit\" />\r\n\t\t\t\t\t\t<template v-else>\r\n\t\t\t\t\t\t\t<img v-if=\"store.user.pz1\" :src=\"$domain + '/' + store.user.pz1\" class=\"avatarEdit\" />\r\n\t\t\t\t\t\t\t<template v-else>\r\n\t\t\t\t\t\t\t\t{{ lang.mine.upload[1] }}\r\n\t\t\t\t\t\t\t</template>\r\n\t\t\t\t\t\t</template>\r\n\t\t\t\t\t</el-upload>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class=\"pz\">\r\n\t\t\t\t\t<el-upload class=\"avatar-uploader\" action=\"https://www.findyourflame.vip:168/upload/pz\"\r\n\t\t\t\t\t\t:show-file-list=\"false\" :before-upload=\"(file) => beforeUpload(file, 2)\"\r\n\t\t\t\t\t\t:on-success=\"(response) => handleSuccess(response, 2)\" :on-error=\"handleError\">\r\n\t\t\t\t\t\t<img v-if=\"imageUrl[2]\" :src=\"imageUrl[2]\" class=\"avatarEdit\" />\r\n\t\t\t\t\t\t<template v-else>\r\n\t\t\t\t\t\t\t<img v-if=\"store.user.pz2\" :src=\"$domain + '/' + store.user.pz2\" class=\"avatarEdit\" />\r\n\t\t\t\t\t\t\t<template v-else>\r\n\t\t\t\t\t\t\t\t{{ lang.mine.upload[2] }}\r\n\t\t\t\t\t\t\t</template>\r\n\t\t\t\t\t\t</template>\r\n\t\t\t\t\t</el-upload>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t\t<div class=\"woman\">\r\n\t\t\t\t<div class=\"avatar\">\r\n\t\t\t\t\t<img :src=\"$domain + '/' + pairUser.avatar\" />\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class=\"pz\">\r\n\t\t\t\t\t<img v-if=\"pairUser.pz\" :width=\"100\"\r\n\t\t\t\t\t\t:src=\"pairUser.pz ? $domain + '/' + pairUser.pz : 'https://cube.elemecdn.com/3/7c/3ea6beec64369c2642b92c6726f1epng.png'\"\r\n\t\t\t\t\t\tclass=\"avatarEdit\" alt=\"Avatar\" />\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class=\"pz\">\r\n\t\t\t\t\t<img v-if=\"pairUser.pz1\" :width=\"100\"\r\n\t\t\t\t\t\t:src=\"pairUser.pz1 ? $domain + '/' + pairUser.pz1 : 'https://cube.elemecdn.com/3/7c/3ea6beec64369c2642b92c6726f1epng.png'\"\r\n\t\t\t\t\t\tclass=\"avatarEdit\" alt=\"Avatar\" />\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class=\"pz\">\r\n\t\t\t\t\t<img v-if=\"pairUser.pz2\" :width=\"100\"\r\n\t\t\t\t\t\t:src=\"pairUser.pz2 ? $domain + '/' + pairUser.pz2 : 'https://cube.elemecdn.com/3/7c/3ea6beec64369c2642b92c6726f1epng.png'\"\r\n\t\t\t\t\t\tclass=\"avatarEdit\" alt=\"Avatar\" />\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t\t<div class=\"foot\"></div>\r\n\t</div>\r\n</template>\r\n\r\n<script setup>\r\nimport {\r\n\tuseRouter,\r\n\tuseRoute\r\n} from 'vue-router';\r\nimport {\r\n\tref,\r\n\tonMounted,\r\n\tonUnmounted,\r\n\treactive,\r\n\tonBeforeMount\r\n} from 'vue';\r\nimport {\r\n\tCarousel\r\n} from 'ant-design-vue';\r\nimport mainApi from '../api/main.js'\r\nimport {\r\n\tElNotification\r\n} from 'element-plus'\r\nimport {\r\n\tmessage\r\n} from 'ant-design-vue';\r\nimport en from '../locales/en.js';\r\nimport zh from '../locales/zh.js';\r\nimport jp from '../locales/jp.js';\r\nimport ko from '../locales/ko.js';\r\nimport vi from '../locales/vi.js';\r\nconst langs = {\r\n\ten,\r\n\tzh,\r\n\tjp,\r\n\tko,\r\n\tvi\r\n}\r\nlet lang = langs[localStorage.getItem('language')]\r\nconst router = useRouter();\r\nconst route = useRoute();\r\nconst user = JSON.parse(localStorage.getItem('user'))\r\nif (!user) {\r\n\trouter.replace('/login');\r\n}\r\nimport {\r\n\tuseCounterStore\r\n} from '../store/index';\r\nimport mineApi from '../api/mine.js'\r\nimport { ElLoading } from 'element-plus'\r\nconst store = useCounterStore();\r\n\r\nconst userInfo = ref({})\r\nconst getUser = () => {\r\n\tmineApi.get_user({\r\n\t\taccount: JSON.parse(localStorage.getItem('user')).account\r\n\t}).then(res => {\r\n\t\tif (res.code == 0) {\r\n\t\t\tconst user = res.rows[0]\r\n\t\t\tconsole.log(user)\r\n\t\t\tdelete user.password\r\n\t\t\tuserInfo.value = user\r\n\t\t\tstore.user = user\r\n\t\t\tconsole.log(store.user)\r\n\t\t\tlocalStorage.setItem('user', JSON.stringify(user))\r\n\t\t} else {\r\n\t\t\tmessage.error('fail');\r\n\t\t}\r\n\t})\r\n}\r\n//初始化用户信息\r\n// getUser()\r\n//查找配对女生\r\nconst pairUser = ref({})\r\nmineApi.pairUser({\r\n\tinviteCode: store.user.inviteCode,\r\n\tvipGrade: 3\r\n}).then(res => {\r\n\tconsole.log(res)\r\n\tif (res.code == 0) {\r\n\t\tpairUser.value = res.rows[0]\r\n\t} else {\r\n\t\tmessage.error('fail')\r\n\t}\r\n})\r\n// 存储头像图片的 URL\r\nconst imageUrl = ref([]);\r\n// 存储提示消息\r\nconst messageEL = ref('');\r\n// 存储消息类型\r\nconst messageType = ref('');\r\n// 上传前的处理函数\r\nconst beforeUpload = async (file, index) => {\r\n\tconst loading = ElLoading.service({\r\n\t\tlock: true,\r\n\t\ttext: 'Loading',\r\n\t\tbackground: 'rgba(0, 0, 0, 0.7)',\r\n\t})\r\n\tconst isJpgOrPng = file.type === 'image/jpeg' || file.type === 'image/png';\r\n\tif (!isJpgOrPng) {\r\n\t\tmessageEL.value = lang.mine.model.message[5]; //'只能上传 JPG/PNG 格式的图片！'\r\n\t\tmessageType.value = 'error';\r\n\t\treturn false;\r\n\t}\r\n\tconst isLt2M = file.size / 1024 / 1024 < 2;\r\n\tif (!isLt2M) {\r\n\t\tmessageEL.value = lang.mine.model.message[6]; //'图片大小不能超过 2MB！'\r\n\t\tmessageType.value = 'error';\r\n\t\treturn false;\r\n\t}\r\n\tconst reader = new FileReader();\r\n\treader.onload = (e) => {\r\n\t\timageUrl.value[index] = e.target.result;\r\n\t\tuserInfo.value[index == 0 ? 'pz' : index == 1 ? 'pz1' : 'pz2'] = imageUrl.value\r\n\t};\r\n\treader.readAsDataURL(file);\r\n\treturn true;\r\n};\r\n// 上传成功的处理函数\r\nconst handleSuccess = (response, index) => {\r\n\t//记录图片名\r\n\tconsole.log(response.file)\r\n\tif (response.code == 0) {\r\n\t\tlet u = userInfo.value\r\n\t\tlet obj = {}\r\n\t\tobj = index == 0 ? {\r\n\t\t\tpz: response.file,\r\n\t\t} : index == 1 ? {\r\n\t\t\tpz1: response.file,\r\n\t\t} : {\r\n\t\t\tpz2: response.file,\r\n\t\t}\r\n\t\tconst loading = ElLoading.service({\r\n\t\t\tlock: true,\r\n\t\t\ttext: 'Loading',\r\n\t\t\tbackground: 'rgba(0, 0, 0, 0.7)',\r\n\t\t})\r\n\t\tloading.close()\r\n\t\tmineApi.set_pz({\r\n\t\t\t...obj,\r\n\t\t\taccount: JSON.parse(localStorage.getItem('user')).account\r\n\t\t}).then(res => {\r\n\t\t\tif (res.code == 0) {\r\n\t\t\t\tgetUser()\r\n\t\t\t} else {\r\n\t\t\t\tmessage.error('fail')\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\tconsole.log(response)\r\n};\r\n// 上传失败的处理函数\r\nconst handleError = () => {\r\n\tmessageEL.value = lang.mine.model.message[7]; //'头像上传失败，请稍后重试！'\r\n\tmessageType.value = 'error';\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.avatarEdit {\r\n\twidth: 100px;\r\n\theight: 160px;\r\n}\r\n\r\n.sec {\r\n\tdisplay: flex;\r\n\tjustify-content: space-around;\r\n\tpadding-bottom: 80px;\r\n}\r\n\r\n.sec>div {\r\n\tdisplay: flex;\r\n\tflex-direction: column;\r\n\talign-items: center;\r\n}\r\n\r\n.sec>div>div {\r\n\tmargin-top: 10px;\r\n}\r\n\r\n.avatar {\r\n\twidth: 100px;\r\n\theight: 100px;\r\n\tborder-radius: 50%;\r\n\tbackground-color: red;\r\n}\r\n\r\n.avatar img {\r\n\tborder-radius: 50%;\r\n}\r\n\r\n.pz {\r\n\twidth: 130px;\r\n\theight: 160px;\r\n\tcolor: #000;\r\n\tdisplay: flex;\r\n\tflex-direction: column;\r\n\tjustify-content: space-around;\r\n\talign-items: center;\r\n}\r\n\r\n.pz img {\r\n\t/* height: 82%; */\r\n}\r\n\r\n.ant-image {\r\n\twidth: 100%;\r\n\t/* height: 80%; */\r\n}\r\n</style>"],"names":["lang","en","zh","jp","ko","vi","router","useRouter","useRoute","store","useCounterStore","userInfo","ref","getUser","mineApi","res","user","message","pairUser","imageUrl","messageEL","messageType","beforeUpload","file","index","ElLoading","reader","e","handleSuccess","response","obj","handleError"],"mappings":"siBA4GA,IAAIA,EAPU,CACb,GAAAC,EACA,GAAAC,EACA,GAAAC,EACA,GAAAC,EACA,GAAAC,CACD,EACiB,aAAa,QAAQ,UAAU,GAChD,MAAMC,EAASC,EAAS,EACVC,EAAW,EACZ,KAAK,MAAM,aAAa,QAAQ,MAAM,CAAC,GAEnDF,EAAO,QAAQ,QAAQ,EAOxB,MAAMG,EAAQC,EAAe,EAEvBC,EAAWC,EAAI,EAAE,EACjBC,EAAU,IAAM,CACrBC,EAAQ,SAAS,CAChB,QAAS,KAAK,MAAM,aAAa,QAAQ,MAAM,CAAC,EAAE,OACpD,CAAE,EAAE,KAAKC,GAAO,CACd,GAAIA,EAAI,MAAQ,EAAG,CAClB,MAAMC,EAAOD,EAAI,KAAK,GACtB,QAAQ,IAAIC,CAAI,EAChB,OAAOA,EAAK,SACZL,EAAS,MAAQK,EACjBP,EAAM,KAAOO,EACb,QAAQ,IAAIP,EAAM,IAAI,EACtB,aAAa,QAAQ,OAAQ,KAAK,UAAUO,CAAI,CAAC,CACpD,MACGC,EAAQ,MAAM,MAAM,CAEvB,CAAE,CACF,EAIMC,EAAWN,EAAI,EAAE,EACvBE,EAAQ,SAAS,CAChB,WAAYL,EAAM,KAAK,WACvB,SAAU,CACX,CAAC,EAAE,KAAKM,GAAO,CACd,QAAQ,IAAIA,CAAG,EACXA,EAAI,MAAQ,EACfG,EAAS,MAAQH,EAAI,KAAK,GAE1BE,EAAQ,MAAM,MAAM,CAEtB,CAAC,EAED,MAAME,EAAWP,EAAI,CAAA,CAAE,EAEjBQ,EAAYR,EAAI,EAAE,EAElBS,EAAcT,EAAI,EAAE,EAEpBU,EAAe,MAAOC,EAAMC,IAAU,CAO3C,GANgBC,EAAU,QAAQ,CACjC,KAAM,GACN,KAAM,UACN,WAAY,oBACd,CAAE,EAEG,EADeF,EAAK,OAAS,cAAgBA,EAAK,OAAS,aAE9D,OAAAH,EAAU,MAAQpB,EAAK,KAAK,MAAM,QAAQ,GAC1CqB,EAAY,MAAQ,QACb,GAGR,GAAI,EADWE,EAAK,KAAO,KAAO,KAAO,GAExC,OAAAH,EAAU,MAAQpB,EAAK,KAAK,MAAM,QAAQ,GAC1CqB,EAAY,MAAQ,QACb,GAER,MAAMK,EAAS,IAAI,WACnB,OAAAA,EAAO,OAAUC,GAAM,CACtBR,EAAS,MAAMK,GAASG,EAAE,OAAO,OACjChB,EAAS,MAAMa,GAAS,EAAI,KAAOA,GAAS,EAAI,MAAQ,OAASL,EAAS,KAC5E,EACCO,EAAO,cAAcH,CAAI,EAClB,EACR,EAEMK,EAAgB,CAACC,EAAUL,IAAU,CAG1C,GADA,QAAQ,IAAIK,EAAS,IAAI,EACrBA,EAAS,MAAQ,EAAG,CACflB,EAAS,MACjB,IAAImB,EAAM,CAAE,EACZA,EAAMN,GAAS,EAAI,CAClB,GAAIK,EAAS,IAChB,EAAML,GAAS,EAAI,CAChB,IAAKK,EAAS,IACjB,EAAM,CACH,IAAKA,EAAS,IACd,EACeJ,EAAU,QAAQ,CACjC,KAAM,GACN,KAAM,UACN,WAAY,oBACf,CAAG,EACO,MAAO,EACfX,EAAQ,OAAO,CACd,GAAGgB,EACH,QAAS,KAAK,MAAM,aAAa,QAAQ,MAAM,CAAC,EAAE,OACrD,CAAG,EAAE,KAAKf,GAAO,CACVA,EAAI,MAAQ,EACfF,EAAS,EAETI,EAAQ,MAAM,MAAM,CAExB,CAAG,CACD,CACD,QAAQ,IAAIY,CAAQ,CACrB,EAEME,EAAc,IAAM,CACzBX,EAAU,MAAQpB,EAAK,KAAK,MAAM,QAAQ,GAC1CqB,EAAY,MAAQ,OACrB"}